import{Q as v}from"./QScrollArea-Dq0GnGzl.js";import{j as C,E as c,p as h,o as n,m as q,l,G as B,I as L,n as u,w as i,k as d,K as M,q as N,T as S,bM as V,bN as z,$ as D}from"./index-Do0CBbdm.js";import{_ as k}from"./MyVirtualScroll.vue_vue_type_script_setup_true_lang-zwac-2S7.js";import{_ as T}from"./MyButton.vue_vue_type_script_setup_true_lang-0geFim1q.js";import{_ as b}from"./RectSkeleton.vue_vue_type_script_setup_true_lang-CpUe4OqW.js";import{_ as A}from"./PostComponent.vue_vue_type_script_setup_true_lang-BXiaNLWl.js";import{_ as E}from"./CommentComponent.vue_vue_type_script_setup_true_lang-DEIzHHbG.js";import"./QScrollObserver-VymQKE2s.js";import"./QSpace-DJsL9YqM.js";import"./QMenu-VlGd84cI.js";import"./format-BFOA4BKc.js";import"./i18n-DwXAnslu.js";import"./ReactionButtons.vue_vue_type_script_setup_true_lang-x7LFGFb4.js";import"./MyChip.vue_vue_type_script_setup_true_lang-b99PVErD.js";const F={class:"container full-height"},I={class:"horizontal-container"},ee=C({__name:"MainView",props:{type:{}},setup($){const p=$,g=["posts","comments"],w={posts:"article",comments:"chat_bubble"},r=c("posts"),o=c([[],[]]),m=[void 0,void 0],f=c(null);function x(a){r.value=a}async function _(a,t,s){try{let e;p.type=="favorites"?e=await V(t,m[a]):e=await z(p.type=="liked",t,m[a]),e.data.success&&e.data.data[t]?(m[a]=e.data.data.next_cursor,t==="posts"?o.value[0].push(...e.data.data[t]):o.value[1].push(...e.data.data[t]),s(!e.data.data.has_more)):s(!0)}catch{s(!0)}}function y(a){o.value[0]=o.value[0].filter(t=>t.post_id!==a),D(()=>{var t;return(t=f.value)==null?void 0:t.updateShowedItems()})}return(a,t)=>(n(),h("div",F,[q("div",I,[(n(),h(B,null,L(g,s=>l(T,{type:"card","is-category":!0,class:u(["full-width",{selected:r.value==s}]),onClick:e=>x(s),key:s,label:a.$t(s),icon:w[s],style:{"z-index":"2"}},null,8,["class","onClick","label","icon"])),64))]),l(S,{name:"crossfade",mode:"out-in"},{default:i(()=>[(n(),d(M,null,[r.value=="posts"?(n(),d(v,{key:0,class:"scroll-area full-height fix-scroll-area",visible:!1},{default:i(()=>[l(k,{items:o.value[0],"item-key":"post_id","infinite-load-type":"bottom",margins:8,onLoadMore:t[0]||(t[0]=(s,e)=>_(0,"posts",e)),ref_key:"virtualScroll",ref:f,"skeleton-height":200},{default:i(({item:s,index:e})=>[l(A,{post:s,class:u({"q-mb-sm":e+1<o.value[0].length}),onDeletePost:y},null,8,["post","class"])]),skeleton:i(()=>[l(b,{height:"200px",class:"card q-mb-sm"})]),_:1},8,["items"])]),_:1})):r.value=="comments"?(n(),d(v,{key:1,class:"scroll-area full-height fix-scroll-area",visible:!1},{default:i(()=>[l(k,{items:o.value[1],"item-key":"comment_id","infinite-load-type":"bottom",margins:8,onLoadMore:t[1]||(t[1]=(s,e)=>_(1,"comments",e)),"skeleton-height":126},{default:i(({item:s,index:e})=>[l(E,{comment:s,class:u({"q-mb-sm":e+1<o.value[1].length})},null,8,["comment","class"])]),skeleton:i(()=>[l(b,{height:"126px",class:"card q-mb-sm"})]),_:1},8,["items"])]),_:1})):N("",!0)],1024))]),_:1})]))}});export{ee as default};
