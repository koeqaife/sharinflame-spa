import{Q as v}from"./QScrollArea-BfWxh7rm.js";import{j as C,E as c,p as h,o as n,m as q,l,G as B,I as L,n as u,w as i,k as d,K as M,q as N,T as S,bM as V,bN as z,$ as D}from"./index-CW-_h3H6.js";import{_ as k}from"./MyVirtualScroll.vue_vue_type_script_setup_true_lang--lf3OY7K.js";import{_ as T}from"./MyButton.vue_vue_type_script_setup_true_lang-aOd0h3La.js";import{_ as b}from"./RectSkeleton.vue_vue_type_script_setup_true_lang-DcvU8W5z.js";import{_ as A}from"./PostComponent.vue_vue_type_script_setup_true_lang-B2KNN0hS.js";import{_ as E}from"./CommentComponent.vue_vue_type_script_setup_true_lang-Bp1Fjw5N.js";import"./QScrollObserver-B0ZGY-Hj.js";import"./QSpace-BLX8xWL2.js";import"./QMenu-Bmlm-oOs.js";import"./format-CjHWdibf.js";import"./i18n-CgE_7Bs0.js";import"./ReactionButtons.vue_vue_type_script_setup_true_lang-BiShpF7h.js";import"./MyChip.vue_vue_type_script_setup_true_lang-DpPNh9Tl.js";const F={class:"container full-height"},I={class:"horizontal-container"},ee=C({__name:"MainView",props:{type:{}},setup(y){const p=y,$=["posts","comments"],g={posts:"article",comments:"chat_bubble"},m=c("posts"),o=c([[],[]]),r=[void 0,void 0],f=c(null);function w(a){m.value=a}async function _(a,s,t){try{let e;p.type=="favorites"?e=await V(s,r[a]):e=await z(p.type=="liked",s,r[a]),e.data.success&&e.data.data[s]?(r[a]=e.data.data.next_cursor,s==="posts"?o.value[0].push(...e.data.data[s]):o.value[1].push(...e.data.data[s]),t(!e.data.data.has_more)):t(!0)}catch{t(!0)}}function x(a){o.value[0]=o.value[0].filter(s=>s.post_id!==a),D(()=>{var s;return(s=f.value)==null?void 0:s.updateShowedItems()})}return(a,s)=>(n(),h("div",F,[q("div",I,[(n(),h(B,null,L($,t=>l(T,{type:"card","is-category":!0,class:u(["full-width",{selected:m.value==t}]),onClick:e=>w(t),key:t,label:a.$t(t),icon:g[t],style:{"z-index":"2"}},null,8,["class","onClick","label","icon"])),64))]),l(S,{name:"crossfade",mode:"out-in"},{default:i(()=>[(n(),d(M,null,[m.value=="posts"?(n(),d(v,{key:0,class:"scroll-area full-height fix-scroll-area",visible:!1},{default:i(()=>[l(k,{items:o.value[0],"item-key":"post_id","infinite-load-type":"bottom",margins:8,onLoadMore:s[0]||(s[0]=(t,e)=>_(0,"posts",e)),ref_key:"virtualScroll",ref:f,"skeleton-height":200,"no-items-key":"no_posts"},{default:i(({item:t,index:e})=>[l(A,{post:t,class:u({"q-mb-sm":e+1<o.value[0].length}),onDeletePost:x},null,8,["post","class"])]),skeleton:i(()=>[l(b,{height:"200px",class:"card q-mb-sm"})]),_:1},8,["items"])]),_:1})):m.value=="comments"?(n(),d(v,{key:1,class:"scroll-area full-height fix-scroll-area",visible:!1},{default:i(()=>[l(k,{items:o.value[1],"item-key":"comment_id","infinite-load-type":"bottom",margins:8,onLoadMore:s[1]||(s[1]=(t,e)=>_(1,"comments",e)),"skeleton-height":126,"no-items-key":"no_comments"},{default:i(({item:t,index:e})=>[l(E,{comment:t,class:u({"q-mb-sm":e+1<o.value[1].length})},null,8,["comment","class"])]),skeleton:i(()=>[l(b,{height:"126px",class:"card q-mb-sm"})]),_:1},8,["items"])]),_:1})):N("",!0)],1024))]),_:1})]))}});export{ee as default};
