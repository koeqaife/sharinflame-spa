import{j as x,D as z,u as D,E as o,W as $,X as N,k as Q,o as A,w as i,ai as I,m as p,l,H as T,Y as f,s as _,aj as B,aa as F}from"./index-Ck4zLN3I.js";import{Q as X,v as j,a as L,b as M}from"./validations-D_m-Syuv.js";import{Q as Y}from"./QPage-BJi_4Hr7.js";import{a as n,_ as E}from"./MyButton.vue_vue_type_script_setup_true_lang-nTcsNPgd.js";const H={class:"q-pa-xs label-section card-section"},W={class:"text-h6"},G={class:"card-section"},ae=x({__name:"RegisterPage",setup(J){const{t}=z(),k=D(),u=o(),d=o(""),m=o(""),c=o(""),V=o(""),v=o(!0),r=o({email:void 0,username:void 0});let g=null;$(d,()=>r.value.username=void 0),$(m,()=>r.value.email=void 0);const b=o(!1),h=I();function S(...e){if(u.value){u.value.classList.add("is-exit");const s=getComputedStyle(u.value),a=s.animationDuration||s.transitionDuration;if(a){let w=0;a.includes("ms")?w=parseFloat(a):a.includes("s")&&(w=parseFloat(a)*1e3),g=setTimeout(()=>{h.push(...e)},w)}else h.push(...e)}else h.push(...e)}const y=e=>e===!0?!0:t(e||""),P=e=>y(j(e)),R=e=>y(L(e)),U=e=>y(M(e)),q=e=>e===c.value||t("passwords_must_match"),C=async()=>{var e,s;b.value=!0;try{(await B(d.value,m.value,c.value)).data.success&&(k.initialized=0,S({path:"/"}))}catch(a){if(F(a))if(((e=a.response)==null?void 0:e.data.error)=="USERNAME_EXISTS")r.value.username=t("username_exists");else if(((s=a.response)==null?void 0:s.data.error)=="USER_ALREADY_EXISTS")r.value.email=t("email_exists");else throw a;else throw a}finally{b.value=!1}};return N(()=>{g&&clearTimeout(g)}),(e,s)=>(A(),Q(Y,{class:"flex flex-center"},{default:i(()=>[p("div",{class:"register-card card",ref_key:"cardRef",ref:u},[p("div",H,[l(n,{icon:"person_add"}),p("div",W,T(e.$t("register")),1)]),p("div",G,[l(X,{onSubmit:C,class:"full-width"},{default:i(()=>[l(f,{outlined:"",modelValue:d.value,"onUpdate:modelValue":s[0]||(s[0]=a=>d.value=a),label:e.$t("username"),"lazy-rules":"",rules:[R],error:r.value.username!==void 0,"error-message":r.value.username,hint:_(t)("reg_hints.username"),class:"q-mb-sm"},{prepend:i(()=>[l(n,{icon:"person"})]),_:1},8,["modelValue","label","rules","error","error-message","hint"]),l(f,{outlined:"",modelValue:m.value,"onUpdate:modelValue":s[1]||(s[1]=a=>m.value=a),label:e.$t("email"),type:"email","lazy-rules":"",rules:[P],error:r.value.email!==void 0,"error-message":r.value.email,class:"q-mb-sm",hint:_(t)("reg_hints.email")},{prepend:i(()=>[l(n,{icon:"mail"})]),_:1},8,["modelValue","label","rules","error","error-message","hint"]),l(f,{outlined:"",modelValue:c.value,"onUpdate:modelValue":s[3]||(s[3]=a=>c.value=a),label:e.$t("password"),type:v.value?"password":"text","lazy-rules":"",rules:[U],class:"q-mb-sm",hint:_(t)("reg_hints.password")},{append:i(()=>[l(n,{icon:v.value?"visibility_off":"visibility",class:"cursor-pointer",onClick:s[2]||(s[2]=a=>v.value=!v.value)},null,8,["icon"])]),prepend:i(()=>[l(n,{icon:"key"})]),_:1},8,["modelValue","label","type","rules","hint"]),l(f,{outlined:"",modelValue:V.value,"onUpdate:modelValue":s[4]||(s[4]=a=>V.value=a),label:e.$t("confirm_password"),type:"password","lazy-rules":"",rules:[q],class:"q-mb-md",hint:_(t)("reg_hints.confirm_password")},{prepend:i(()=>[l(n,{icon:"key"})]),_:1},8,["modelValue","label","rules","hint"]),l(E,{label:e.$t("register"),type:"primary","btn-type":"submit",class:"full-width centered","icon-right":"check",loading:b.value},null,8,["label","loading"]),l(E,{type:"outlined",label:e.$t("login"),onClick:s[5]||(s[5]=a=>S({path:"/login"})),"icon-right":"login",class:"full-width q-mt-sm centered"},null,8,["label"])]),_:1})])],512)]),_:1}))}});export{ae as default};
