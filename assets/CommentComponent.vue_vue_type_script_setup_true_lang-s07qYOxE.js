const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/OpenUserDialog-DwG3rgCa.js","assets/index-CFDL-CVp.js","assets/index-CIwtCw06.css","assets/MyButton.vue_vue_type_script_setup_true_lang-BrbV-gT4.js","assets/CommentMoreMenu-HVM4hjCM.js","assets/ClosePopup-jbb-qhvq.js","assets/profile-store-3JWJIDcz.js","assets/format-CB8cfGO0.js","assets/MyItem.vue_vue_type_script_setup_true_lang-BiqkFfnH.js"])))=>i.map(i=>d[i]);
import{j as S,E as f,V as $,a2 as j,u as x,X as z,p as C,o as v,q as D,m as a,l as i,H as k,s as _,t as w,w as E,k as K,n as O,_ as A,bJ as q,aa as p,bI as G,bK as H}from"./index-CFDL-CVp.js";import{Q as U}from"./QSpace-Bx2Tzmy6.js";import{Q as F}from"./QMenu-BeQtP8gf.js";import{a as J,b as X}from"./format-CB8cfGO0.js";import{_ as W,a as Y}from"./ReactionButtons.vue_vue_type_script_setup_true_lang-Bl9fB1-t.js";import{a as Z,_ as R}from"./MyButton.vue_vue_type_script_setup_true_lang-BrbV-gT4.js";import{i18n as B}from"./i18n-BoPRfTTY.js";const ee={key:0,class:"card-section replied-to-section"},oe={class:"label"},te={class:"card-section content-section"},ae={class:"avatar-container"},ne={class:"text-container"},se={class:"username"},ie={class:"reaction-buttons"},re={class:"action-container"},le={class:"action-container circle"},ve=S({__name:"CommentComponent",props:{isParent:{type:Boolean},comment:{},hideGoTo:{type:Boolean},inDialog:{type:Boolean},inRepliesDialog:{type:Boolean}},emits:["deleteComment"],setup(L,{emit:T}){const N=w(()=>A(()=>import("./OpenUserDialog-DwG3rgCa.js"),__vite__mapDeps([0,1,2,3]))),P=w(()=>A(()=>import("./CommentMoreMenu-HVM4hjCM.js"),__vite__mapDeps([4,1,2,5,6,7,3,8])));let n=null;const g=T,s=L,y=f(!1),e=$(s.comment),m=f(!1),l=f(!1),c=j(),d=x();function V(){y.value=!0}async function I(){const{t}=B.global;try{await H(e.value.post_id,e.value.comment_id),c.notify({type:"default-notification",progress:!0,icon:"sym_r_delete_forever",message:t("comment_deleted.msg"),caption:t("comment_deleted.caption")}),g("deleteComment",e.value.comment_id),m.value=!0}catch(u){throw c.notify({type:"error-notification",progress:!0,message:t("comment_deleted.failed")}),u}}async function M(t,u){var b,h;const{t:r}=B.global;switch(t){case"delete":d.openDialog("okCancel","",{localeKey:"delete_comment_dialog",okKey:"delete",okType:"attention",okIcon:"delete_forever"},()=>void I());break;case"go_to_post":{l.value=!0;try{n||(n=new AbortController);const o=await G(s.comment.post_id,{signal:n.signal});o.data.success&&d.openDialog("post",o.data.data.post_id,{post:o.data.data,autoLoad:!1,...!e.value.parent_comment_id&&{firstComment:s.comment}}),l.value=!1}catch(o){if(p(o)&&o.code=="ERR_CANCELED")return;p(o)&&((b=o.response)==null?void 0:b.status)==404?c.notify({type:"error-notification",message:r("resource_not_found")}):c.notify({type:"error-notification",message:r("an_error_occurred")})}break}case"jump_to_replied":l.value=!0;try{n||(n=new AbortController);const o=await q(s.comment.post_id,s.comment.parent_comment_id,{signal:n.signal});o.data.success&&d.openDialog("replies",o.data.data.comment_id,{comment:o.data.data,firstComment:e.value,autoLoad:!1,inDialog:s.inDialog}),l.value=!1}catch(o){if(p(o)&&o.code=="ERR_CANCELED")return;p(o)&&((h=o.response)==null?void 0:h.status)==404?c.notify({type:"error-notification",message:r("resource_not_found")}):c.notify({type:"error-notification",message:r("an_error_occurred")})}break;case"report":d.openDialog("report","",{targetType:"comment",targetId:e.value.post_id});break;case"copy_id":navigator.clipboard.writeText(u);break}}function Q(){s.inRepliesDialog||d.openDialog("replies",e.value.comment_id,{comment:e.value,onDelete:()=>{m.value=!0,g("deleteComment",e.value.comment_id)},inDialog:s.inDialog})}return z(()=>{n&&n.abort()}),(t,u)=>(v(),C("div",{class:"card comment",key:e.value.comment_id},[t.isParent?(v(),C("div",ee,[i(Z,{icon:"reply"}),a("div",oe,k(t.$t("replied_to")),1)])):D("",!0),a("div",te,[a("div",ae,[i(_(N),{user:e.value.user},null,8,["user"])]),a("div",ne,[a("div",se,k(e.value.user.display_name||e.value.user.username),1),i(W,{class:"content",text:_(J)(e.value.content),html:!0},null,8,["text"])])]),a("div",{class:O(["actions card-section actions-section",{"can-animate":y.value}])},[a("div",ie,[i(Y,{object:e.value,"before-action":V,"is-comment":!0,disable:m.value},null,8,["object","disable"])]),a("div",re,[i(R,{icon:"reply",label:_(X)(e.value.replies_count),class:"comments round button",size:"sm",onClick:Q,disable:m.value},null,8,["label","disable"])]),i(U),a("div",le,[i(R,{icon:"more_horiz",class:"more button circle",size:"sm",disable:m.value,loading:l.value},{default:E(()=>[l.value?D("",!0):(v(),K(F,{key:0,class:"comment-more-menu",self:"top right"},{default:E(()=>{var r;return[i(_(P),{comment:e.value,onAction:M,"show-go-to":!t.hideGoTo&&!((r=t.inDialog)==null||r)},null,8,["comment","show-go-to"])]}),_:1}))]),_:1},8,["disable","loading"])])],2)]))}});export{ve as _};
