import{j as V,D as C,u as D,E as r,W as y,k as R,o as x,w as i,m,l as o,H as P,Y as b,ai as Q,ak as q,aa as I}from"./index-Do0CBbdm.js";import{Q as N,v as O,b as T}from"./validations-8Vd7OWW9.js";import{Q as z}from"./QPage-CKZeylTW.js";import{a as p,_ as h}from"./MyButton.vue_vue_type_script_setup_true_lang-0geFim1q.js";const B={class:"q-pa-xs label-section card-section"},F={class:"text-h6"},U={class:"card-section"},M=V({__name:"LoginPage",setup(A){const{t:v}=C(),f=Q(),S=D(),n=r(),u=r(""),d=r(""),c=r(!0),l=r({email:"",password:""});y(u,()=>l.value.email=""),y(d,()=>l.value.password="");const _=r(!1);function g(...e){if(n.value){n.value.classList.add("is-exit");const s=getComputedStyle(n.value),a=s.animationDuration||s.transitionDuration;if(a){let t=0;a.includes("ms")?t=parseFloat(a):a.includes("s")&&(t=parseFloat(a)*1e3),setTimeout(()=>{f.push(...e)},t)}else f.push(...e)}else f.push(...e)}const w=e=>e===!0?!0:v(e||""),k=e=>w(O(e)),$=e=>w(T(e)),E=async()=>{var e,s;l.value.email="",l.value.password="",_.value=!0;try{(await q(u.value,d.value)).data.success&&(S.initialized=0,g({path:"/"}))}catch(a){if(I(a)){const t=(s=(e=a.response)==null?void 0:e.data)==null?void 0:s.error;if(t==="INCORRECT_PASSWORD")l.value.password=v("incorrect_password");else if(t==="USER_DOES_NOT_EXIST")l.value.email=v("user_does_not_exist");else throw a}else throw a}finally{_.value=!1}};return(e,s)=>(x(),R(z,{class:"flex flex-center"},{default:i(()=>[m("div",{class:"login-card card",ref_key:"cardRef",ref:n},[m("div",B,[o(p,{icon:"login"}),m("div",F,P(e.$t("login")),1)]),m("div",U,[o(N,{onSubmit:E,class:"full-width"},{default:i(()=>[o(b,{outlined:"",modelValue:u.value,"onUpdate:modelValue":s[0]||(s[0]=a=>u.value=a),label:e.$t("email"),type:"email","lazy-rules":"",rules:[k],class:"q-mb-sm",error:!!l.value.email,"error-message":l.value.email},{prepend:i(()=>[o(p,{icon:"mail"})]),_:1},8,["modelValue","label","rules","error","error-message"]),o(b,{outlined:"",modelValue:d.value,"onUpdate:modelValue":s[2]||(s[2]=a=>d.value=a),label:e.$t("password"),type:c.value?"password":"text","lazy-rules":"",rules:[$],class:"q-mb-sm",error:!!l.value.password,"error-message":l.value.password},{append:i(()=>[o(p,{icon:c.value?"visibility_off":"visibility",class:"cursor-pointer",onClick:s[1]||(s[1]=a=>c.value=!c.value)},null,8,["icon"])]),prepend:i(()=>[o(p,{icon:"key"})]),_:1},8,["modelValue","label","type","rules","error","error-message"]),o(h,{label:e.$t("login"),type:"primary","btn-type":"submit",class:"full-width centered","icon-right":"check",loading:_.value},null,8,["label","loading"]),o(h,{type:"outlined",label:e.$t("register"),onClick:s[3]||(s[3]=a=>g({path:"/register"})),"icon-right":"person_add",class:"full-width centered q-mt-sm"},null,8,["label"])]),_:1})])],512)]),_:1}))}});export{M as default};
