const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/OpenUserDialog-9mRkPefj.js","assets/index-Do0CBbdm.js","assets/index-DI-gpe9-.css","assets/MyButton.vue_vue_type_script_setup_true_lang-0geFim1q.js","assets/CommentMoreMenu-BCnxqKPt.js","assets/ClosePopup-uR4tGjqj.js","assets/profile-store-DKzKeDwC.js","assets/format-BFOA4BKc.js","assets/MyItem.vue_vue_type_script_setup_true_lang-DynlXqQa.js"])))=>i.map(i=>d[i]);
import{j as I,E as f,V as M,a2 as Q,u as S,X as j,p as z,o as C,m as s,l as r,s as _,t as D,H as P,w as h,k as K,q as O,n as $,_ as k,bJ as q,aa as p,bI as G,bK as H}from"./index-Do0CBbdm.js";import{Q as U}from"./QSpace-DJsL9YqM.js";import{Q as F}from"./QMenu-VlGd84cI.js";import{a as J,b as X}from"./format-BFOA4BKc.js";import{_ as W,a as Y}from"./ReactionButtons.vue_vue_type_script_setup_true_lang-x7LFGFb4.js";import{_ as w}from"./MyButton.vue_vue_type_script_setup_true_lang-0geFim1q.js";import{i18n as E}from"./i18n-DwXAnslu.js";const Z={class:"card-section content-section"},ee={class:"avatar-container"},oe={class:"text-container"},te={class:"username"},ae={class:"reaction-buttons"},ne={class:"action-container"},se={class:"action-container circle"},_e=I({__name:"CommentComponent",props:{comment:{},hideGoTo:{type:Boolean},inDialog:{type:Boolean},inRepliesDialog:{type:Boolean}},emits:["deleteComment"],setup(A,{emit:R}){const B=D(()=>k(()=>import("./OpenUserDialog-9mRkPefj.js"),__vite__mapDeps([0,1,2,3]))),L=D(()=>k(()=>import("./CommentMoreMenu-BCnxqKPt.js"),__vite__mapDeps([4,1,2,5,6,7,3,8])));let t=null;const v=R,a=A,g=f(!1),e=M(a.comment),m=f(!1),l=f(!1),c=Q(),d=S();function T(){g.value=!0}async function x(){const{t:n}=E.global;try{await H(e.value.post_id,e.value.comment_id),c.notify({type:"default-notification",progress:!0,icon:"sym_r_delete_forever",message:n("comment_deleted.msg"),caption:n("comment_deleted.caption")}),v("deleteComment",e.value.comment_id),m.value=!0}catch(u){throw c.notify({type:"error-notification",progress:!0,message:n("comment_deleted.failed")}),u}}async function N(n,u){var y,b;const{t:i}=E.global;switch(n){case"delete":d.openDialog("okCancel","",{localeKey:"delete_comment_dialog",okKey:"delete",okType:"attention",okIcon:"delete_forever"},()=>void x());break;case"go_to_post":{l.value=!0;try{t||(t=new AbortController);const o=await G(a.comment.post_id,{signal:t.signal});o.data.success&&d.openDialog("post",o.data.data.post_id,{post:o.data.data,autoLoad:!1,...!e.value.parent_comment_id&&{firstComment:a.comment}}),l.value=!1}catch(o){if(p(o)&&o.code=="ERR_CANCELED")return;p(o)&&((y=o.response)==null?void 0:y.status)==404?c.notify({type:"error-notification",message:i("resource_not_found")}):c.notify({type:"error-notification",message:i("an_error_occurred")})}break}case"jump_to_replied":l.value=!0;try{t||(t=new AbortController);const o=await q(a.comment.post_id,a.comment.parent_comment_id,{signal:t.signal});o.data.success&&d.openDialog("replies",o.data.data.comment_id,{comment:o.data.data,firstComment:e.value,autoLoad:!1,inDialog:a.inDialog}),l.value=!1}catch(o){if(p(o)&&o.code=="ERR_CANCELED")return;p(o)&&((b=o.response)==null?void 0:b.status)==404?c.notify({type:"error-notification",message:i("resource_not_found")}):c.notify({type:"error-notification",message:i("an_error_occurred")})}break;case"report":d.openDialog("report","",{targetType:"comment",targetId:e.value.post_id});break;case"copy_id":navigator.clipboard.writeText(u);break}}function V(){a.inRepliesDialog||d.openDialog("replies",e.value.comment_id,{comment:e.value,onDelete:()=>{m.value=!0,v("deleteComment",e.value.comment_id)},inDialog:a.inDialog})}return j(()=>{t&&t.abort()}),(n,u)=>(C(),z("div",{class:"card comment",key:e.value.comment_id},[s("div",Z,[s("div",ee,[r(_(B),{user:e.value.user},null,8,["user"])]),s("div",oe,[s("div",te,P(e.value.user.display_name||e.value.user.username),1),r(W,{class:"content",text:_(J)(e.value.content),html:!0},null,8,["text"])])]),s("div",{class:$(["actions card-section actions-section",{"can-animate":g.value}])},[s("div",ae,[r(Y,{object:e.value,"before-action":T,"is-comment":!0,disable:m.value},null,8,["object","disable"])]),s("div",ne,[r(w,{icon:"reply",label:_(X)(e.value.replies_count),class:"comments round button",size:"sm",onClick:V,disable:m.value},null,8,["label","disable"])]),r(U),s("div",se,[r(w,{icon:"more_horiz",class:"more button circle",size:"sm",disable:m.value,loading:l.value},{default:h(()=>[l.value?O("",!0):(C(),K(F,{key:0,class:"comment-more-menu",self:"top right"},{default:h(()=>{var i;return[r(_(L),{comment:e.value,onAction:N,"show-go-to":!n.hideGoTo&&!((i=n.inDialog)==null||i)},null,8,["comment","show-go-to"])]}),_:1}))]),_:1},8,["disable","loading"])])],2)]))}});export{_e as _};
